<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Payment</title>
<link href="css/ipaylinks20150704.css" rel="stylesheet" type="text/css" />
<script src="<@sp.static/>/js/pay/common/jquery-1.3.2.js" type="text/javascript"></script>

</head>

<body>
	
	<div class="box01">
		<!-- 半透明遮罩层 -->
		<div id="a1" style="display:none;background-color:gray;margin:0px 0px;position:absolute; z-index:9999;opacity:0.2;text-align:center;padding-top:50px;color:red;"></div>
		<!-- loadding层 -->
		<div id="animate" style="display:none;width:800px;height:520px;position:absolute; z-index:99999;text-align:center;padding-top:100px;color:red;"> <!-- margin:20px 550px; -->
		
			<img src="images/loadding.gif" style="opacity:1;" />
			<div style="margin:30px auto;">The order is being processed. Please wait for a moment.</div>
		</div>
		<div class="box_inner_01">
			<div class="inner_title">Please fill in the credit card information</div>
		</div>
		<div class="box_inner_02">
			<!--图片样式-->
			<div class="image_show">
			
				<div class="show01">
					<img src="images/visa.png" alt="图片不存在" id="visaImg"/>
				</div>
				<div class="show02">
					<img src="images/master-灰.png" alt="图片不存在" id="masterImg"/>
				</div>
				
			</div>
			<div class="clear"></div>
<form action="${rc.contextPath}/crosspay.htm?method=onSubmit" method="post" id="frm1">			
			<!--填写数据样式-->
			<div class="form">
				<div class="fitem">
					<label>卡号：</label><input type="text" name="cardHolderNumber" id="cardHolderNumber" value="" /><span>*</span><tip id="cardHolderNumberTip"></tip>
				</div>
				<div class="fitem">
					<label>有效期：</label>
					<select id="cardExpirationMonth" name="cardExpirationMonth"> 
						<option value=""></option> 
						<option value="01">01</option> 
						<option value="02">02</option> 
						<option value="03">03</option> 
						<option value="04">04</option> 
						<option value="05">05</option> 
						<option value="06">06</option> 
						<option value="07">07</option> 
						<option value="08">08</option> 
						<option value="09">09</option> 
						<option value="10">10</option> 
						<option value="11">11</option> 
						<option value="12">12</option> 
					</select>
					<span style="width:26px;color:#000000;" >/</span>
					<select id="cardExpirationYear" name="cardExpirationYear">
						<option></option>
						<option value="16">2016</option>
						<option value="17">2017</option>
						<option value="18">2018</option>
						<option value="19">2019</option>
						<option value="20">2020</option>
						<option value="21">2021</option>
						<option value="22">2022</option>
						<option value="23">2023</option>
						<option value="24">2024</option>
						<option value="25">2025</option>
						<option value="26">2026</option>
						<option value="27">2027</option>
						<option value="28">2028</option>
						<option value="29">2029</option>
						<option value="30">2030</option>
					</select>
					<span>*</span><tip id="cardExpirationTip"></tip>
				</div>
				<div class="fitem">
					<label>名：</label><input type="text" name="cardHolderFirstName" id="cardHolderFirstName" /><span>*</span><tip id="cardHolderFirstNameTip"></tip>
				</div>
				<div class="fitem">
					<label>姓：</label><input type="text" name="cardHolderLastName" id="cardHolderLastName"/><span>*</span><tip id="cardHolderLastNameTip"></tip>
				</div>
				<div class="fitem" style="position:relative;top:-10px;">
					<label>CVV：</label><input type="text" style="width:93px;height:31px;" id="securityCode" name="securityCode" maxlength="3" /><span>*</span>
					<img src="images/cvv.png" alt="图片不存在" style="position:relative;top:10px;margin-left:100px;"/>&nbsp;&nbsp;<tip id="securityCodeTip"></tip>
				</div>
				<div class="fitem" style="height:42px;">
					<label></label>
					<input type="button" id="submit" value="submit" class="fsubmit" style="width:181px;height:32px;"/>&nbsp;&nbsp;<tip id="resultTip"></tip>
				</div>
			</div>
<input type="hidden" name="tradeOrderNo" id="tradeOrderNo" value="${tradeOrderNo}"/>			
<input type="hidden" name="partnerId" id="partnerId" value="${partnerId}"/>			
<input type="hidden" name="orderAmount" id="orderAmount" value="${orderAmount}"/>			
<input type="hidden" name="currencyCode" id="currencyCode" value="${currencyCode}"/>			
<input type="hidden" name="orderId" id="orderId" value="${orderId}"/>			
<input type="hidden" name="payType" value="${payType!'ALL'}"/>			
</form>			
		</div>
	</div>
<script type="text/javascript">

function check(){
	var cardHolderNumber = $('#cardHolderNumber').val();
	if('' == cardHolderNumber){
		$('#cardHolderNumberTip').html('Please fill in Card Number.');
		return false;
	}
	var cardExpirationMonth = $('#cardExpirationMonth').val();
	if('' == cardExpirationMonth){
		$('#cardExpirationTip').html('Please choose Valid Month.');
		return false;
	}
	var cardExpirationYear = $('#cardExpirationYear').val();
	if('' == cardExpirationYear){
		$('#cardExpirationTip').html('Please choose Valid Year.');
		return false;
	}
	var cardHolderFirstName = $('#cardHolderFirstName').val();
	if('' == cardHolderFirstName){
		$('#cardHolderFirstNameTip').html('Please fill in First Name.');
		return false;
	}
	var cardHolderLastName = $('#cardHolderLastName').val();
	if('' == cardHolderLastName){
		$('#cardHolderLastNameTip').html('Please fill in last Name.');
		return false;
	}
	var securityCode = $('#securityCode').val();
	if('' == securityCode){
		$('#securityCodeTip').html('Please fill in Card Verification Value.');
		return false;
	}
	
	return true;
}

String.prototype.startWith=function(str){

    var reg=new RegExp("^"+str);
    return reg.test(this);
}


$(function(){
	
	$("#cardHolderNumber").blur(function(){
		var cardHolderNumber = $('#cardHolderNumber').val();
		if('' != cardHolderNumber){
			$('#cardHolderNumberTip').html('');
		}
		if(cardHolderNumber.startWith("4")){
			$("#visaImg").attr("src","images/visa.png");
			$("#masterImg").attr("src","images/master-灰.png");
		}else if(cardHolderNumber.startWith("5")){
			$("#visaImg").attr("src","images/visa-灰.png");
			$("#masterImg").attr("src","images/master.png");
		}
		
	});
	
	$("#cardExpirationMonth").blur(function(){
		var cardExpirationMonth = $('#cardExpirationMonth').val();
		if('' != cardExpirationMonth){
			$('#cardExpirationTip').html('');
		}
		
	});
	
	$("#cardExpirationYear").blur(function(){
		var cardExpirationMonth = $('#cardExpirationMonth').val();
		var cardExpirationYear = $('#cardExpirationYear').val();
		if('' != cardExpirationMonth && '' != cardExpirationYear){
			$('#cardExpirationTip').html('');
		}
		
	});
	
	$("#cardHolderFirstName").blur(function(){
		var cardHolderFirstName = $('#cardHolderFirstName').val();
		if('' != cardHolderFirstName){
			$('#cardHolderFirstNameTip').html('');
		}
	});
	
	$("#cardHolderLastName").blur(function(){
		var cardHolderLastName = $('#cardHolderLastName').val();
		if('' != cardHolderLastName){
			$('#cardHolderLastNameTip').html('');
		}
	});
	
	$("#securityCode").blur(function(){
		var securityCode = $('#securityCode').val();
		if('' != securityCode){
			$('#securityCodeTip').html('');
		}
	});
	
	$("#submit").click(function(){
		
		$('#resultTip').html('');
		if(check()){
			
			shade();
			
			var pars = $("#frm1").serialize();
			window.location.href='${rc.contextPath}/crosspay.htm?method=onSubmit&'+pars;
		}
		
	});

});

function shade(){
	
	var box01Width = $(".box01").width();
	var box01Height = $(".box01").innerHeight() ;
	
	var inner02Width = $(".box_inner_02").width();
	var inner02Height = $(".box_inner_02").height();
	
	var animateMarginTop = (box01Height - inner02Height) / 2 ;
	var animateMarginLeft = (box01Width - inner02Width) / 2 ;
	
	$("#a1").css({width:box01Width, height:box01Height - 50 ,display:'block'});
	$("#animate").css("margin-top", animateMarginTop);
	$("#animate").css("margin-left", animateMarginLeft);
	$("#animate").css({width:inner02Width,height:inner02Height,display:'block'});
}

</script>
</body>
</html>
